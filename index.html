<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Grande annonce</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="des infos sur le mariage">
    <meta name="author" content="samy">

    <!-- Le styles -->
    <link href="./bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 40px; /* 40px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="./bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

	<!-- le custom --> 
	<link href="./css/letsjam.css" rel="stylesheet">
	
	<!-- le font --> 
	<link href="http://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
	<link href="http://fonts.googleapis.com/css?family=Cabin" rel="stylesheet" type="text/css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="./bootstrap/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./bootstrap/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./bootstrap/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./bootstrap/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="./bootstrap/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="./bootstrap/ico/favicon.png">
  </head>

  <body data-spy="scroll" data-target=".navbar" data-offset="400">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

	<div class="container" style="width:100%">
		
    <div class="navbar navbar-fixed-top navbar-static-top"> 
      <div class="navbar-inner">
		<a class="brand hidden-phone" href="#">Mariage Anne-Gaëlle et Samy</a>
            <ul class="nav pull-right">
              <li class="menu_entry"><a href="#mainevent">Good news everyone!</a></li>
			  
			  <li class="dropdown">
					<a class="dropdown-toggle" data-toggle="dropdown" href="#">
						Je viens, bien sûr!
						<b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li class="menu_entry">
							<a href="#ou">Mais ça se passe où?</a>
						</li>
						<li class="menu_entry">
							<a href="#quand">Et ça se passe quand?</a>
						</li>
						<li class="menu_entry">
							<a href="#contact">Comment vous contacter?</a>
						</li>
					</ul>
				</li>
			  
			  <li class="divider-vertical"></li>
				<li class="dropdown">
					<a class="dropdown-toggle" data-toggle="dropdown" href="#">
						Je voudrais savoir...
						<b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li class="menu_entry">
							<a href="#dresscode">... quel est le dresscode?</a>
						</li>
						<li class="menu_entry">
							<a href="#logis">... où peut-on loger?</a>
						</li>
						<li class="menu_entry">
							<a href="#enfants">... que faire des enfants?</a>
						</li>
						<li class="menu_entry">
							<a href="#liste">... avez-vous une liste de mariage?</a>
						</li>
					</ul>
				</li>
            </ul>
        </div>
      </div>


	
	<div id="content">
	
		<div id="main">
			
			<div class="block" id="mainevent" >
			<div >
				<h1>Anne-Gaëlle et Samy se marient!</h1>
				<p>Hé oui! Après toutes ces aventures depuis 8 ans, vous ne vous y attendiez plus (ou pas)! On ne va pas dire que nous non plus, mais presque!</p>
				<p>Alors un mariage vient en général avec tout plein de questions; ce site a pour but de répondre à vos interrogations afin de vous permettre de venir nous retrouver dans les meilleures conditions possibles!</p>
			</div>
			</div>
			
			<div class="block" id="ou">
			<div >
				<h2>Où?</h2>
				<p><img src="img/x.jpg" title="Merci Junior!"/></p>
				<p>Le mariage se déroulera à la Mairie de <strong>Chatillon sur Seine</strong>, à 1h de Dijon et 2h30 de Paris.</p>
				<div id="mobile_map" class="visible-phone map">
				</div>
				<p>Comment venir?</p>
				<ul>
				<li><strong>en voiture</strong>: Les doux vallons de l'autoroute A5 et A6 peuvent nous amener à nous.</li>
				<li><strong>en train</strong>: La gare la plus proche de Chatillon sur Seine se trouve à Montbard, et un service de bus relie les deux villes. Si vous avez besoin de transport entre Montbard et Chatillon sur Seine, faites-le nous savoir.
				</li>
				</ul>
			</div>
			</div>
			
			<div class="block" id="quand" >
			<div>
				<h2>Quand?</h2>
				<p>Réglez vos calendriers sur le 21 septembre 2013, à 16h. Pour les plus précis d'entre vous c'est dans <span id="remainingDays"></span> jours!</p>
			</div>
			</div>
			
			<div class="block" id="contact" >
			<div>
				<h2>Comment nous contacter?</h2>
				<p>Si vous n'avez pas de projecteur suffisament puissant pour balayer le ciel avec nos initiales, vous pouvez utiliser les moyens suivants:</p>
				<ul>
					<li><strong>par email</strong>: <a href="mailto:mariage@beaudoux.net">mariage@beaudoux.net</a></li>
					<li><strong>par courrier</strong>: Anne-Gaëlle Donnet et Samy Beaudoux, 8 rue Seguin, 69002 Lyon</li>
				</ul>
			</div>
			</div>
			
			<div class="block" id="dresscode">
			<div >
				<h2>Quel est le dresscode?</h2>
				<p>Notre humour facétieux et sophistiqué pourrait nous pousser à prôner le costume de poulet ou les maillots de bain. Néammoins c'est une question sérieuse aussi nous répondrons simplement qu'il n'y a pas de dresscode particulier demandé pour les invités.</p>
				<p>Prévoyez quand même une petite laine au cas ou l'automne soit particulièrement brumeux.</p>
			</div>
			</div>

			<div class="block" id="logis">
			<div >
				<h2>Où peut-on loger?</h2>
				<p>Une liste d'hôtels/gîtes/chambres d'hôte à proximité du lieu du vin d'honneur et du repas est disponible ci-dessous. Cliquez sur un lieu pour le voir sur la carte:</p>
				<ul id="logements">
					
				</ul>
				<p>Il est possible de camper sur les lieux du mariage pour les afficionados de la toile de tente. Merci de nous prévenir si vous choisissez cette solution.</p>
			</div>
			</div>
			
			<div class="block" id="enfants">
			<div >
				<h2>Et les enfants?</h2>
				<p>Nous sommes actuellement à la recherche des clones de Mary Poppins nécessaires à la garde des enfants pendant le repas, ces derniers seront gardés dans le gîte jouxtant la salle du mariage. Il se peut toutefois que les possibilités de garde soient modifiées en cas d'inexistence de clones de Mary Poppins...</p>
				<p>Autant vous dire que ça va modifier sec.</p>
				<p>Cette section sera mise à jour ultérieurement quand nous aurons plus d'informations.</p>
			</div>
			</div>
			
			<div class="block" id="liste">
			<div >
				<h2>Avez-vous une liste de mariage?</h2>
				<pre style=display:none">
Autrefois pour faire sa cour
On parlait d'amour
Pour mieux prouver son ardeur
On offrait son coeur
Maintenant c'est plus pareil
Ça change ça change
Pour séduire le cher ange
On lui glisse à l'oreille

Ah Gudule, viens m'embrasser, et je te donnerai...

Un frigidaire, un joli scooter, un atomixer
Et du Dunlopillo
Une cuisinière, avec un four en verre
Des tas de couverts et des pelles à gâteau!
Une tourniquette pour faire la vinaigrette
Un bel aérateur pour bouffer les odeurs
Des draps qui chauffent
Un pistolet à gaufres
Un avion pour deux...
Et nous serons heureux!

Autrefois s'il arrivait
Que l'on se querelle
L'air lugubre on s'en allait
En laissant la vaisselle
Maintenant que voulez-vous
La vie est si chère
On dit: "rentre chez ta mère"
Et on se garde tout

Ah Gudule, excuse-toi, ou je reprends tout ça...

Mon frigidaire, mon armoire à cuillers
Mon évier en fer, et mon poêle à mazout
Mon cire-godasses, mon repasse-limaces
Mon tabouret-à-glace et mon chasse-filous!
La tourniquette, à faire la vinaigrette
Le ratatine ordures et le coupe friture

Et si la belle se montre encore rebelle
On la ficelle dehors, pour confier son sort...

Au frigidaire, à l'efface-poussière
A la cuisinière, au lit qu'est toujours fait
Au chauffe-savates, au canon à patates
A l'éventre-tomate, à l'écorche-poulet!

Mais très très vite
On reçoit la visite
D'une tendre petite
Qui vous offre son coeur

Alors on cède
Car il faut qu'on s'entraide
Et l'on vit comme ça jusqu'à la prochaine fois
Et l'on vit comme ça jusqu'à la prochaine fois
Et l'on vit comme ça jusqu'à la prochaine fois</pre>
			</div>
			</div>
			
			<div class="block" id="liste">
			<div >
				<h2>Cette page contient-elle un passage secret?</h2>
				<p>Bientôt... :)</p>
			</div>
			</div>
		</div>
	
		<div id="company" class="hidden-phone">
		
			<div id="mainevent_illustration" class="illustration">
				<span class="legend">le mariage (allégorie) par Matthias B.</span>
			</div>
			
			<div id="ou_illustration" class="illustration map">
			</div>
			
			<div id="quand_illustration" class="illustration">
			</div>
			
			<div id="contact_illustration" class="illustration">
			</div>
			
			<div id="dresscode_illustration" class="illustration">
			</div>
			
			<div id="logis_illustration" class="illustration map">
			</div>
			
			<div id="enfants_illustration" class="illustration">
			</div>
			
			<div id="liste_illustration" class="illustration">
			</div>
		</div>
	</div>
	</div>
	
    <!-- Le javascript
    ================================================== -->
	<script src="./bootstrap/js/jquery.js" type="text/javascript"></script> <!-- jquery from bootstrap -->
    <script src="./bootstrap/js/bootstrap.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&language=fr"></script>
    <script>
	var booh = null;
		$(function() {
		
			var SideBar = $("#company");
			var Illustrations = $("#company .illustration");
			var Blocks = $("#main .block");
			var ScrollSpy = $('[data-spy="scroll"]');
			var Main = $("#main");
		
			var changeDimensions = function(){
				var bodyheight = $(window).height() - 40;
				Illustrations.height(bodyheight);
				Blocks.css("min-height", bodyheight);
				SideBar.width($(window).width() - Main.width());
			}
			
			
			var calculateTopIllustration = function() {
				var topValue = $($("li.menu_entry.active a").attr('href') + "_illustration")[0].offsetTop;
				SideBar.animate({top: topValue * -1 + 40}, 300);
			};

			var refreshScrollSpy = function() {
				ScrollSpy.each(function () {
					var $spy = $(this).scrollspy('refresh')
				});
			}
			
			// changeons les dimensions initiales
			changeDimensions();
			// on s'accroche au redimensionnement
			$(window).resize(function() {
				changeDimensions();
				calculateTopIllustration();
				refreshScrollSpy();
			});
			// en cas de changement de menu actif
			$(".navbar ul li").on("activate", function() {
				calculateTopIllustration();
			});
			
			
			var LatLngChatillonSurSeine = new google.maps.LatLng(47.860455, 4.573714);
			var LatLngAiseyBonEspoir = new google.maps.LatLng(47.755541,4.56512);
			
			var mapOptions = {
				zoom: 7,
				streetViewControl: false,
				center: LatLngChatillonSurSeine,
				mapTypeId: google.maps.MapTypeId.ROADMAP 
			};
			var mapIllustration = new google.maps.Map(document.getElementById('ou_illustration'), mapOptions);
			var mapMobile = new google.maps.Map(document.getElementById('mobile_map'), mapOptions);
			
			var mapLogisOptions = {
				zoom: 10,
				streetViewControl: false,
				center: LatLngChatillonSurSeine,
				mapTypeId: google.maps.MapTypeId.ROADMAP 
			};
			var mapLogis = new google.maps.Map(document.getElementById('logis_illustration'), mapLogisOptions);
			booh = mapLogis;
			/* les amrkers sur la carte de la mairie */
			var markerIllustration = new google.maps.Marker({
				position: LatLngChatillonSurSeine,
				map: mapIllustration,
				title: 'C\'est ici!'
			});
			var markerMobile = new google.maps.Marker({
				position: LatLngChatillonSurSeine,
				map: mapMobile,
				title: 'C\'est ici!'
			});
			
			/* les markers sur la carte de bon espoir */
			var markerBonEspoir = new google.maps.Marker({
				position: LatLngAiseyBonEspoir,
				map: mapLogis,
				title: 'Vin d\'honneur et repas'
			});
					
			function daysTill() {
			  //----------  EDIT THE VARIABLES BELOW  ------------------
			  // EDIT THE VARIABLES BELOW
			  var day=	21; // Day
			  var month=	9; // Month
			  var year=	2013; //Year
			  //----------  END OF EDIT  -------------------------------

			  var daystocount=new Date(year, month -1, day);
			  today=new Date();
			  if (today.getMonth()==month && today.getDate()>day) {
				daystocount.setFullYear(daystocount.getFullYear());
				}
			  var oneday=1000*60*60*24;
			  return (Math.ceil((daystocount.getTime()-today.getTime())/(oneday)));
			}
			
			/* combien de jours? */
			$("#remainingDays").text(daysTill().toString());
			
			
			/* templating! Rick Strahl's */
			var _tmplCache = {}
			this.parseTemplate = function(str, data) {
				/// <summary>
				/// Client side template parser that uses <#= #> and <# code #> expressions.
				/// and # # code blocks for template expansion.
				/// NOTE: chokes on single quotes in the document in some situations
				///       use &rsquo; for literals in text and avoid any single quote
				///       attribute delimiters.
				/// </summary>    
				/// <param name="str" type="string">The text of the template to expand</param>    
				/// <param name="data" type="var">
				/// Any data that is to be merged. Pass an object and
				/// that object's properties are visible as variables.
				/// </param>    
				/// <returns type="string" />  
				var err = "";
				try {
					var func = _tmplCache[str];
					if (!func) {
						var strFunc =
						"var p=[],print=function(){p.push.apply(p,arguments);};" +
									"with(obj){p.push('" +
						//                        str
						//                  .replace(/[\r\t\n]/g, " ")
						//                  .split("<#").join("\t")
						//                  .replace(/((^|#>)[^\t]*)'/g, "$1\r")
						//                  .replace(/\t=(.*?)#>/g, "',$1,'")
						//                  .split("\t").join("');")
						//                  .split("#>").join("p.push('")
						//                  .split("\r").join("\\'") + "');}return p.join('');";

						str.replace(/[\r\t\n]/g, " ")
						   .replace(/'(?=[^#]*#>)/g, "\t")
						   .split("'").join("\\'")
						   .split("\t").join("'")
						   .replace(/<#=(.+?)#>/g, "',$1,'")
						   .split("<#").join("');")
						   .split("#>").join("p.push('")
						   + "');}return p.join('');";

						//alert(strFunc);
						func = new Function("obj", strFunc);
						_tmplCache[str] = func;
					}
					return func(data);
				} catch (e) { err = e.message; }
				return ""; //"< # ERROR: " + err.htmlEncode() + " # >";
			}
			
			/* ok, maintenant peuplons les logis :) */
			var logis = [
				{"Id":"htelDeLaCtedor", "Nom":"Hôtel de La Côte-d'or", "Adresse": "2, rue Charles Ronot, Chatillon sur Seine", "Telephone": "03 80 91 13 29", "Infos":["email: remillet.gerard@club-internet.fr", "hôtel trois étoiles", "70-80€ la chambre", "9 chambres"], "Lat":47.858302, "Lng":4.571176},
{"Id":"htelLaMontagne", "Nom":"Hôtel La Montagne", "Adresse": "12, rue Maréchal de Lattre de Tassigny, Chatillon sur Seine", "Telephone": "03 80 91 10 61", "Infos":["40€ la chambre", "12 chambres", "http://www.hotel-restaurant-lamontagne.com/hotel-chatillon-sur-seine-restaurant-bourgogne-21.html"], "Lat":48.78732, "Lng":2.232771},
{"Id":"leSaintVorles", "Nom":"Le Saint Vorles", "Adresse": "1, Rue prés Carnot, Chatillon sur Seine", "Telephone": "03 80 81 55 83", "Infos":["à partir de 47€"], "Lat":47.860494, "Lng":4.573197},
{"Id":"htelDuChevalRouge", "Nom":"Hôtel du Cheval rouge", "Adresse": "4 place du 8 Mai 1945, Chatillon sur Seine", "Telephone": "03 80 81 53 70", "Infos":["à partir de 43€"], "Lat":47.859777, "Lng":4.571696},
{"Id":"sylviaHotel", "Nom":"Sylvia Hotel", "Adresse": "9 avenue de la gare, Chatillon sur Seine", "Telephone": "03 80 91 02 44", "Infos":["<a href=\"mailto:bob@bob.fr\">sylviahotel@wanadoo.fr</a>", "hôtel deux étoiles", "57€ la chambre", "17 chambres"], "Lat":47.867401, "Lng":4.573138},
{"Id":"tipazaExOllin", "Nom":"Tipaza (ex Ollin)", "Adresse": "32 avenue de la gare, Chatillon sur Seine", "Telephone": "03 80 91 28 25", "Infos":["aucune note"], "Lat":47.868996, "Lng":4.572561},
{"Id":"htelrestaurantDeLaPoste", "Nom":"Hôtel-restaurant de la Poste", "Adresse": "6, rue Amont, Villaines en duesmois", "Telephone": "03 80 89 03 01", "Infos":["à partir de 50€", "4 chambres"], "Lat":47.680631, "Lng":4.525489},
			];

			var allMarkers = {};//{"sample": {"mapMarker": null, "mapWindow": null, "domElement": null}};
			
			function createMarker(logisInfos) {
				var newmarker = new google.maps.Marker({
					position: new google.maps.LatLng(logisInfos["Lat"], logisInfos["Lng"]),
					map: mapLogis,
					title: "" //logisInfos["Nom"] + " - " + logisInfos["Adresse"]
				});
				newmarker["clicked"] = false;

				var newInfoWindow = new google.maps.InfoWindow({
						content: document.parseTemplate($("#LogisTemplate").html(), logisInfos)
					});
				
				var newEntry = $("<li id='" + logisInfos["Id"] + "' class='Logis'>" + document.parseTemplate($("#LogisTemplate").html(), logisInfos) + "</li>");
				$("#logements").append(newEntry);
				
				newmarker['infowindow'] = newInfoWindow;
				newmarker['control'] = newEntry;
				newInfoWindow['marker'] = newmarker;
				newInfoWindow['control'] = newEntry;
				newEntry['infowindow'] = newInfoWindow;
				newEntry['marker'] = newmarker;
				
				google.maps.event.addListener(newmarker, 'mouseover', function() {
					if (!this['infowindow'].getMap()) {
						this['infowindow'].open(mapLogis, this);
					}
				});
						
				google.maps.event.addListener(newmarker, 'mouseout', function() {
					if (!this["clicked"]) this['infowindow'].close();
				});
				
				google.maps.event.addListener(newmarker, 'click', function() {
					currentlyClickedMarker = newmarker;
					$(".SelectedLogis").removeClass("SelectedLogis");
					var blockInfos = this['control'];
					window.scrollTo(0, blockInfos.position().top - 50);
					$.each( allMarkers, function( key, value ) {
						value["mapWindow"].close();
						value["mapMarker"]["clicked"] = false;
					});
					if (!this['infowindow'].getMap()) {
						this['infowindow'].open(mapLogis, this);
					}
					this['clicked'] = true;
					blockInfos.addClass("SelectedLogis");
				});
				
				google.maps.event.addListener(newInfoWindow, 'clickclose', function() {
					this['marker']['clicked'] = false;
					this['control'].removeClass("SelectedLogis");
					this.close();
				});
				
				newEntry.on("click", function() {
					$(".SelectedLogis").removeClass("SelectedLogis");
					$.each( allMarkers, function( key, value ) {
						value["mapWindow"].close();
					});
					mapLogis.setCenter(newmarker.getPosition()); 
					if (!newInfoWindow.getMap()) {
						newInfoWindow.open(mapLogis, newmarker);
					}
					newmarker["clicked"] = true;
					$(this).addClass("SelectedLogis");
				});
				
				allMarkers[logisInfos["Id"]] = {"mapMarker": newmarker, "mapWindow": newInfoWindow, "domElement": newEntry};
				
			}
			
			$.each(logis, function() {
				createMarker(this);
			});
			
			
		});

	</script>
	
	<script id="LogisTemplate" type="text/html">
		<div class="InfoBlock">
		<div class="MainData">
			<div class="Nom"><#= Nom #></div>
			<div class="Adresse"><#= Adresse #></div>
			<div class="Telephone"><#= Telephone #></div>
		</div>
		</div>
		<div class="InfoBlock">
		<div class="AdditionalData">
			<ul>
				<# for(var i=0; i < Infos.length; i++)     
				{ #>
				<li><#= Infos[i]#></li>
				<# } #>
			</ul>
		</div>
		</div>
	</script>
  </body>
</html>
